SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO


























CREATE PROCEDURE [dbo].[SP_FILLBOMARANCEL9801ALL]    as

SET NOCOUNT ON 
DECLARE @Fecha varchar(11), @INSERTO INT, @EMPAQUE INT


	SELECT @Fecha =(convert(varchar(11), getdate(),101))


TRUNCATE TABLE BOM_ARANCEL 

SELECT @INSERTO=AR_INSERTO, @EMPAQUE=AR_EMPAQUEUSA FROM CONFIGURACION

--MP ORIGINARIA
IF @INSERTO IS NOT NULL AND @INSERTO<>0
BEGIN

	INSERT INTO BOM_ARANCEL (MA_CODIGO, AR_CODIGO, BA_TIPOCOSTO, BA_COSTO)
	SELECT     MA_CODIGO, @INSERTO, 'N', 0   
	FROM         MAESTROCOST
	WHERE     (TCO_CODIGO = 1) AND (MA_NG_USA > 0)
		AND MA_PERINI <=GETDATE() AND MA_PERFIN >=GETDATE()
	GROUP BY MA_CODIGO
END

/*
mp retorno 9801001097
inserto y retrabajo 9802008068
empaque 9801001010

*/


--EMPAQUE NO GRAVABLE
IF @EMPAQUE IS NOT NULL AND @EMPAQUE<>0
BEGIN
	INSERT INTO BOM_ARANCEL (MA_CODIGO, AR_CODIGO, BA_TIPOCOSTO, BA_COSTO)
	SELECT     MA_CODIGO, @EMPAQUE, '3', 0   
	FROM         MAESTROCOST
	WHERE     (TCO_CODIGO = 1) AND (MA_NG_EMP > 0)
		AND MA_PERINI <=GETDATE() AND MA_PERFIN >=GETDATE()
	GROUP BY MA_CODIGO
END

























GO
