SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO























CREATE PROCEDURE [dbo].[SP_ACTUALIZAEQ_TASA_MAESTROALL]   as



alter table Maestro disable trigger Update_Maestro 



	UPDATE    MAESTRO
	SET              MA_PESO_KG =0.453597, MA_PESO_LB = 1
	WHERE     (ME_COM = 43)
	
	
	UPDATE    MAESTRO
	SET              MA_PESO_KG =1, MA_PESO_LB = 2.20462442018378
	WHERE     (ME_COM = 36)


	UPDATE MAESTRO
	SET     MA_PESO_KG= ROUND(MA_PESO_LB/2.20462442018378,6)
	FROM         MAESTRO
	WHERE     (MA_PESO_KG = 0) AND (MA_PESO_LB > 0)
	
	UPDATE MAESTRO
	SET     MA_PESO_LB= ROUND(MA_PESO_KG*2.20462442018378,6)
	FROM         MAESTRO
	WHERE     (MA_PESO_KG > 0) AND (MA_PESO_LB = 0)



	exec SP_ACTUALIZAEQARANCELALL


	exec SP_ACTUALIZAEQGENALL


	exec SP_ACTUALIZAEQCATEGALL


	UPDATE MAESTRO
	SET SPI_CODIGO=22
	WHERE MA_DEF_TIP='P' AND PA_ORIGEN=233 AND (SPI_CODIGO<>22 OR SPI_CODIGO IS NULL)



	begin tran
	UPDATE  BOM_STRUCT
	SET     BOM_STRUCT.ME_CODIGO= MAESTRO.ME_COM
	FROM         BOM_STRUCT INNER JOIN
	                      MAESTRO ON BOM_STRUCT.BST_HIJO = MAESTRO.MA_CODIGO
	WHERE     (BOM_STRUCT.ME_CODIGO = 0) AND MAESTRO.ME_COM<>0
	commit tran

	begin tran
	UPDATE BOM_STRUCT
	SET     BOM_STRUCT.ME_GEN= MAESTRO_1.ME_COM
	FROM         BOM_STRUCT INNER JOIN
	                      MAESTRO ON BOM_STRUCT.BST_HIJO = MAESTRO.MA_CODIGO INNER JOIN
	                      MAESTRO MAESTRO_1 ON MAESTRO.MA_GENERICO = MAESTRO_1.MA_CODIGO AND BOM_STRUCT.ME_GEN <> MAESTRO_1.ME_COM
	commit tran


	begin tran
	UPDATE BOM_STRUCT
	SET     BOM_STRUCT.FACTCONV= MAESTRO.EQ_GEN
	FROM         BOM_STRUCT INNER JOIN
	                     MAESTRO ON dbo.BOM_STRUCT.BST_HIJO = MAESTRO.MA_CODIGO AND BOM_STRUCT.ME_CODIGO = MAESTRO.ME_COM AND 
	                      BOM_STRUCT.FACTCONV <> MAESTRO.EQ_GEN
	commit tran

alter table Maestro enable trigger Update_Maestro






















GO
