SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO



































CREATE VIEW dbo.VPEDIMENTOFACTIMP
with encryption as
SELECT    (SELECT PATENTE_FOLIO FROM  VPEDIMP WHERE PI_CODIGO=(CASE WHEN FACTIMP.PI_RECTIFICA>-1 THEN FACTIMP.PI_RECTIFICA ELSE FACTIMP.PI_CODIGO END)) AS PATENTE_FOLIO,
(SELECT CP_CLAVE FROM  CLAVEPED WHERE CP_CODIGO=(CASE WHEN FACTIMP.PI_RECTIFICA>-1 THEN (SELECT CP_CODIGO FROM PEDIMP WHERE PI_CODIGO=FACTIMP.PI_RECTIFICA) ELSE 
(SELECT CP_CODIGO FROM PEDIMP WHERE PI_CODIGO=FACTIMP.PI_CODIGO) END)) AS CP_CLAVE,
(CASE WHEN PI_RECTIFICA>-1 THEN PI_RECTIFICA ELSE PI_CODIGO END) AS PI_CODIGO, FI_CODIGO
FROM         FACTIMP


































GO
