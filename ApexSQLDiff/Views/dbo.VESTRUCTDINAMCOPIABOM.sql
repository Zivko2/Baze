SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO































CREATE VIEW dbo.VESTRUCTDINAMCOPIABOM
with encryption as
SELECT     dbo.FACTEXPDET.FE_CODIGO, dbo.FACTEXPDET.FED_INDICED, dbo.FACTEXPDET.MA_CODIGO, dbo.BOM_DESCTEMP.BST_HIJO, 
                      dbo.MAESTRO.MA_NOPARTE, dbo.MAESTRO.MA_NOMBRE, dbo.MAESTRO.MA_NAME, SUM(dbo.BOM_DESCTEMP.BST_INCORPOR) 
                      AS BST_INCORPOR, dbo.MAESTRO.TI_CODIGO, dbo.BOM_DESCTEMP.ME_CODIGO, dbo.MAESTRO.MA_GENERICO, 
                      MAX(dbo.BOM_DESCTEMP.ME_GEN) AS ME_GEN, ISNULL(dbo.BOM_DESCTEMP.FACTCONV, 1) AS FACTCONV, 
                      SUM(dbo.BOM_DESCTEMP.BST_INCORPOR * ISNULL(dbo.BOM_DESCTEMP.FACTCONV, 1)) AS RE_INCORPORGEN, dbo.MAESTRO.AR_IMPFO, 
                      dbo.VMAESTROCOST.MA_COSTO, dbo.BOM_DESCTEMP.BST_TIPOCOSTO
FROM         dbo.MAESTRO LEFT OUTER JOIN
                      dbo.VMAESTROCOST ON dbo.MAESTRO.MA_CODIGO = dbo.VMAESTROCOST.MA_CODIGO RIGHT OUTER JOIN
                      dbo.BOM_DESCTEMP RIGHT OUTER JOIN
                      dbo.FACTEXPDET ON dbo.BOM_DESCTEMP.FED_INDICED = dbo.FACTEXPDET.FED_INDICED ON 
                      dbo.MAESTRO.MA_CODIGO = dbo.BOM_DESCTEMP.BST_HIJO LEFT OUTER JOIN
                      dbo.CONFIGURATIPO ON dbo.FACTEXPDET.TI_CODIGO = dbo.CONFIGURATIPO.TI_CODIGO
WHERE     (dbo.BOM_DESCTEMP.BST_DISCH = 'S') AND (dbo.BOM_DESCTEMP.FACT_INV = 'F') AND (dbo.CONFIGURATIPO.CFT_TIPO = 'S' OR
                      dbo.CONFIGURATIPO.CFT_TIPO = 'P') AND (dbo.BOM_DESCTEMP.BST_INCORPOR > 0) AND (dbo.BOM_DESCTEMP.FED_CANT > 0)
GROUP BY dbo.FACTEXPDET.MA_CODIGO, dbo.BOM_DESCTEMP.BST_HIJO, dbo.BOM_DESCTEMP.FACTCONV, dbo.FACTEXPDET.FED_INDICED, 
                      dbo.FACTEXPDET.FE_CODIGO, dbo.MAESTRO.MA_NOPARTE, dbo.MAESTRO.MA_NOMBRE, dbo.MAESTRO.MA_NAME, dbo.MAESTRO.TI_CODIGO, 
                      dbo.BOM_DESCTEMP.ME_CODIGO, dbo.MAESTRO.MA_GENERICO, dbo.BOM_DESCTEMP.BST_INCORPOR * dbo.BOM_DESCTEMP.FACTCONV, 
                      dbo.MAESTRO.AR_IMPFO, dbo.VMAESTROCOST.MA_COSTO, dbo.BOM_DESCTEMP.BST_TIPOCOSTO
HAVING      (dbo.FACTEXPDET.MA_CODIGO IS NOT NULL)































GO
