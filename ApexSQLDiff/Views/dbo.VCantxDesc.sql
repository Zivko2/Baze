SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO







































CREATE VIEW dbo.VCantxDesc
with encryption as
select B1.FED_INDICED,FACTEXP.FE_FECHA,B1.BST_HIJO AS MA_CODIGO,B1.BST_NIVEL,B1.FED_CANT,
IsNULL(
FED_SALDOGEN * B1.BST_INCORPOR*B1.FED_CANT*B1.FACTCONV /
(
SELECT SUM(B2.BST_INCORPOR * B2.FED_CANT * B2.FACTCONV)
FROM BOM_DESCTEMP B2
LEFT OUTER JOIN FACTEXP ON B2.FE_CODIGO = FACTEXP.FE_CODIGO
WHERE (FACTEXP.FE_FECHA >= TEMP_INVENTARIOS.PI_FECHA ) AND B2.BST_HIJO = B1.BST_HIJO
) ,0)
as CantXDesc
from BOM_DESCTEMP B1
LEFT OUTER JOIN FACTEXP ON FACTEXP.FE_CODIGO = B1.FE_CODIGO
LEFT OUTER JOIN TEMP_INVENTARIOS ON TEMP_INVENTARIOS.MA_CODIGO = B1.BST_HIJO AND TEMP_INVENTARIOS.PI_FECHA <= FACTEXP.FE_FECHA




GO
