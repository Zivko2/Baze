SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW dbo.VPEDIMPDETORIGEN
with encryption as
SELECT     dbo.FACTIMP.FI_FOLIO, dbo.FACTIMP.FI_FECHA, 'PID_INDICED'=CASE WHEN dbo.FACTIMPDET.PID_INDICEDLIGAR1 <>-1 AND dbo.FACTIMPDET.PID_INDICEDLIGAR1 is not null
		THEN dbo.FACTIMPDET.PID_INDICEDLIGAR1 ELSE  dbo.FACTIMPDET.PID_INDICEDLIGA END, dbo.FACTIMP.TF_CODIGO, dbo.FACTIMP.TQ_CODIGO, 
                      dbo.FACTIMP.FI_TIPO
FROM         dbo.FACTIMPDET INNER JOIN
                      dbo.FACTIMP ON dbo.FACTIMPDET.FI_CODIGO = dbo.FACTIMP.FI_CODIGO
UNION
SELECT     dbo.FACTEXP.FE_FOLIO, dbo.FACTEXP.FE_FECHA, 'PID_INDICED'=CASE WHEN dbo.FACTEXPDET.PID_INDICEDLIGAR1 <>-1 AND dbo.FACTEXPDET.PID_INDICEDLIGAR1 is not null
		THEN dbo.FACTEXPDET.PID_INDICEDLIGAR1 ELSE  dbo.FACTEXPDET.PID_INDICEDLIGA END, dbo.FACTEXP.TF_CODIGO, dbo.FACTEXP.TQ_CODIGO, 
                      dbo.FACTEXP.FE_TIPO
FROM         dbo.FACTEXPDET INNER JOIN
                      dbo.FACTEXP ON dbo.FACTEXPDET.FE_CODIGO = dbo.FACTEXP.FE_CODIGO



GO
