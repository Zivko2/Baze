SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW dbo.VFACTIMP
with encryption as
SELECT     FI_CODIGO, FI_FOLIO, FI_FECHA, TF_CODIGO, TQ_CODIGO, FI_TIPO, FI_PINICIAL, FI_PFINAL, FC_CODIGO, FI_NO_SEM, AG_MEX, AG_USA, 
                      PR_CODIGO, DI_PROVEE, CL_PROD, DI_PROD, CL_DESTINT, DI_DESTINT, CL_DESTFIN, DI_DESTFIN, CL_COMP, DI_COMP, CL_VEND, DI_VEND, 
                      CL_EXP, DI_EXP, CL_IMP, DI_IMP, ZO_CODIGO, PU_CARGA, PU_SALIDA, PU_ENTRADA, PU_DESTINO, FI_FEC_ENV, FI_FEC_ARR, MT_CODIGO, 
                      CT_CODIGO, CA_CODIGO, FI_TRAC_MX, FI_TRAC_US, TCA_CODIGO, CJ_CODIGO, FI_CONT_REG, 
                      FI_SELLO, FI_TRANS_CHO, FI_COMENTA, FI_COMENTAUS, US_CODIGO, RU_CODIGO, 
                      YA_CODIGO, FI_NOINB, FI_TOTALB, FI_TIPOCAMBIO, FI_NUM_EMB, FI_DOCUMENTO, FI_INBOND, FI_FACTAGRU, FI_ESTATUS, 
	       'PI_CODIGO'=CASE WHEN PI_RECTIFICA<0 THEN PI_CODIGO ELSE PI_RECTIFICA END,  FI_CUENTADET,
                     FI_PI_ENUSO, FI_CANCELADO, MO_CODIGO, IT_CODIGO, FI_MANIFIESTO, FI_GUIA, SPI_CODIGO, CP_CODIGO, 
                      ALM_CODIGO, FI_FECFIANZA, FI_PASARCONTENEDOR, FI_DESCRIPTION1, FI_DESCRIPTION2, FI_INVOICETYPE, FI_HEADER, FI_FOOTER, 
                      FI_USACONSOLIDADO, TN_CODIGO, FI_NUM_INBON, FI_TIPO_INBON, FI_FEC_INBON, FI_BARCODE, FI_NUMVEHICULOS, BC_CODIGO, MT_ORIGEN, 
                      FI_GUIAORIGEN
FROM         dbo.FACTIMP
WHERE FI_CANCELADO<>'S'






GO
