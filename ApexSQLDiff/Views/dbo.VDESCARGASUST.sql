SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

















































































































CREATE VIEW dbo.VDESCARGASUST
with encryption as
SELECT     dbo.FACTEXPDET.FE_CODIGO, dbo.FACTEXPDET.FED_INDICED, dbo.FACTEXPDET.MA_CODIGO, dbo.BOM_DESCTEMP.BST_HIJO, 
                      dbo.BOM_DESCTEMP.BST_PT, SUM(dbo.BOM_DESCTEMP.BST_INCORPOR) AS BST_INCORPOR, dbo.BOM_DESCTEMP.FACTCONV, 
                      MAX(dbo.BOM_DESCTEMP.ME_GEN) AS ME_GEN
FROM         dbo.MAESTRO RIGHT OUTER JOIN
                      dbo.BOM_DESCTEMP RIGHT OUTER JOIN
                      dbo.FACTEXPDET ON dbo.BOM_DESCTEMP.FED_INDICED = dbo.FACTEXPDET.FED_INDICED ON 
                      dbo.MAESTRO.MA_CODIGO = dbo.BOM_DESCTEMP.BST_HIJO LEFT OUTER JOIN
                      dbo.CONFIGURATIPO ON dbo.FACTEXPDET.TI_CODIGO = dbo.CONFIGURATIPO.TI_CODIGO
WHERE     (dbo.BOM_DESCTEMP.BST_DISCH = 'S') AND (dbo.CONFIGURATIPO.CFT_TIPO = 'S' OR
                      dbo.CONFIGURATIPO.CFT_TIPO = 'P') AND (dbo.FACTEXPDET.FED_RETRABAJO = 'N')
GROUP BY dbo.FACTEXPDET.FE_CODIGO, dbo.FACTEXPDET.FED_INDICED, dbo.FACTEXPDET.MA_CODIGO, dbo.BOM_DESCTEMP.BST_HIJO, 
                      dbo.BOM_DESCTEMP.BST_PT, dbo.BOM_DESCTEMP.FACTCONV
HAVING      (dbo.FACTEXPDET.MA_CODIGO IS NOT NULL)



































































GO
