SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO







































CREATE VIEW dbo.VENUSO
with encryption as
SELECT     dbo.FACTIMPDET.MA_CODIGO
	FROM         dbo.FACTIMP INNER JOIN
	                      dbo.FACTIMPDET ON dbo.FACTIMP.FI_CODIGO = dbo.FACTIMPDET.FI_CODIGO INNER JOIN
	                      dbo.CONFIGURATIPO ON dbo.FACTIMPDET.TI_CODIGO = dbo.CONFIGURATIPO.TI_CODIGO
	WHERE     (dbo.FACTIMP.FI_FECHA >= GETDATE() - ((SELECT CF_TIEMPOUSO FROM CONFIGURACION)*30.416))
	GROUP BY dbo.FACTIMPDET.MA_CODIGO
	union
SELECT     PEDIMPDET.MA_CODIGO
	FROM         VPEDIMP INNER JOIN
	                   PEDIMPDET ON VPEDIMP.PI_CODIGO = PEDIMPDET.PI_CODIGO INNER JOIN
	                      dbo.CONFIGURATIPO ON PEDIMPDET.TI_CODIGO = dbo.CONFIGURATIPO.TI_CODIGO
	WHERE     (VPEDIMP.PI_FEC_ENT >= GETDATE() - ((SELECT CF_TIEMPOUSO FROM CONFIGURACION)*30.416))
	GROUP BY PEDIMPDET.MA_CODIGO
union
SELECT     dbo.FACTEXPDET.MA_CODIGO
		FROM         dbo.FACTEXP INNER JOIN
		                      dbo.FACTEXPDET ON dbo.FACTEXP.FE_CODIGO = dbo.FACTEXPDET.FE_CODIGO INNER JOIN
		                      dbo.CONFIGURATIPO ON dbo.FACTEXPDET.TI_CODIGO = dbo.CONFIGURATIPO.TI_CODIGO
		WHERE     (dbo.FACTEXP.FE_FECHA >= GETDATE() - ((SELECT CF_TIEMPOUSO FROM CONFIGURACION)*30.416))
		GROUP BY dbo.FACTEXPDET.MA_CODIGO












































GO
