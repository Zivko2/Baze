SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW dbo.VFACTORACT
with encryption as
SELECT     dbo.PEDIMP.PI_CODIGO, 'FACTORACT'=CASE WHEN (SELECT CF_FACTORACT FROM dbo.CONFIGURACION)='I' THEN (CASE WHEN VINPCMIN.IN_CANT>0 THEN isnull(dbo.VINPCMAX.IN_CANT,0)/isnull(dbo.VINPCMIN.IN_CANT,0) ELSE 0 END)
	else (CASE WHEN dbo.VTCAMBIOMIN.TC_CANTDOF>0 THEN isnull(dbo.VTCAMBIOMAX.TC_CANTDOF,0) /isnull(dbo.VTCAMBIOMIN.TC_CANTDOF,0) ELSE 0 END) end
FROM         dbo.PEDIMP LEFT OUTER JOIN
                      dbo.VTCAMBIOMAX ON dbo.PEDIMP.PI_CODIGO = dbo.VTCAMBIOMAX.PI_CODIGO LEFT OUTER JOIN
                      dbo.VINPCMIN ON dbo.PEDIMP.PI_CODIGO = dbo.VINPCMIN.PI_CODIGO LEFT OUTER JOIN
                      dbo.VINPCMAX ON dbo.PEDIMP.PI_CODIGO = dbo.VINPCMAX.PI_CODIGO LEFT OUTER JOIN
                      dbo.VTCAMBIOMIN ON dbo.PEDIMP.PI_CODIGO = dbo.VTCAMBIOMIN.PI_CODIGO



GO
