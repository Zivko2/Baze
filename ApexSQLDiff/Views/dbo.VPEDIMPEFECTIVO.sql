SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW dbo.VPEDIMPEFECTIVO
with encryption as
SELECT     PI_CODIGO, SUM(ROUND(PIT_CONTRIBTOTMN, 0)) AS PIT_CONTRIBTOTMN
FROM         (SELECT dbo.PEDIMPCONTRIBUCION.PI_CODIGO, 
	    SUM(ROUND(dbo.PEDIMPCONTRIBUCION.PIT_CONTRIBTOTMN,
	     0)) AS PIT_CONTRIBTOTMN
	FROM dbo.PEDIMPCONTRIBUCION INNER JOIN
	    dbo.TPAGO ON 
	    dbo.PEDIMPCONTRIBUCION.PG_CODIGO = dbo.TPAGO.PG_CODIGO
	WHERE (dbo.TPAGO.PG_CLAVE = '0')
	GROUP BY dbo.PEDIMPCONTRIBUCION.PI_CODIGO
	UNION
	SELECT dbo.PEDIMPDETBCONTRIBUCION.PI_CODIGO, 
	    SUM(ROUND(dbo.PEDIMPDETBCONTRIBUCION.PIB_CONTRIBTOTMN,
	     0)) AS PIT_CONTRIBTOTMN
	FROM dbo.PEDIMPDETBCONTRIBUCION INNER JOIN
	    dbo.TPAGO ON 
	    dbo.PEDIMPDETBCONTRIBUCION.PG_CODIGO = dbo.TPAGO.PG_CODIGO
	WHERE (dbo.TPAGO.PG_CLAVE = '0')
	GROUP BY dbo.PEDIMPDETBCONTRIBUCION.PI_CODIGO) PEDIMPEFECTIVO1
GROUP BY PI_CODIGO




GO
